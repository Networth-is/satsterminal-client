!function(){console.log("YAYYYY ITS LOADING");const e=new Set,o=new Set,t={};function r(e){return Object.keys(e).filter((o=>"function"==typeof e[o]))}function n(t){const n=window[t];if(n&&!o.has(t)){if("XverseProviders"===t&&n.BitcoinProvider){const e=r(n);document.querySelectorAll("iframe").forEach((o=>{o.contentWindow.postMessage({type:"PROVIDER_METADATA",providerName:"XverseProviders",methods:e},"*")}));const o=r(n.BitcoinProvider);document.querySelectorAll("iframe").forEach((e=>{e.contentWindow.postMessage({type:"PROVIDER_METADATA",providerName:"XverseProviders.BitcoinProvider",methods:o},"*")}))}else{const e=r(n);document.querySelectorAll("iframe").forEach((o=>{o.contentWindow.postMessage({type:"PROVIDER_METADATA",providerName:t,methods:e},"*")}))}e.add(t)}}window.addEventListener("message",(e=>{if("PROVIDER_ACKNOWLEDGMENT"===e.data.type){const{providerName:t}=e.data;o.add(t),console.log(`Acknowledgment received for provider: ${t}`),o.size===s.length&&(console.log("All providers acknowledged, stopping observer"),i.disconnect())}if("CALL_METHOD"===e.data.type||"SUBSCRIBE_EVENT"===e.data.type){const{providerName:o,methodName:r,args:n,requestId:s,eventName:i}=e.data;let d=window[o.split(".")[0]];"XverseProviders.BitcoinProvider"===o&&(d=d&&d.BitcoinProvider),"CALL_METHOD"===e.data.type&&d&&"function"==typeof d[r]&&d[r](...n).then((o=>{e.source.postMessage({type:"METHOD_RESPONSE",requestId:s,result:o},e.origin)})).catch((o=>{e.source.postMessage({type:"METHOD_RESPONSE",requestId:s,error:o.message},e.origin)})),"SUBSCRIBE_EVENT"===e.data.type&&d&&"function"==typeof d.on&&(t[o]||(t[o]={}),t[o][i]||(t[o][i]=[],d.on(i,(e=>{t[o][i].forEach((t=>{t.contentWindow.postMessage({type:"EVENT_TRIGGER",providerName:o,eventName:i,data:e},"*")}))}))),t[o][i].push(e.source))}}));const s=["unisat","XverseProviders","magicEden","okxwallet","LeatherProvider","phantom","OrangeWalletProviders"];s.forEach((e=>{window[e]&&n(e)}));const i=new MutationObserver((()=>{s.forEach(n)}));i.observe(document.documentElement,{childList:!0,subtree:!0}),setTimeout((()=>{i&&(console.log("Stopping observer after timeout"),i.disconnect())}),3e4),window.addEventListener("beforeunload",(()=>i.disconnect()))}();